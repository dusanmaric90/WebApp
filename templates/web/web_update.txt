<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
	<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
	<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
	<html>
		<head>
			<title>Izmeni {{name}}</title>
			
			
			
<script type="text/javascript">
	
	function provera(){
		
		{% for dictionary in attributes %}
		{% if dictionary["one_to_many"] is not defined %}
		{% if dictionary["required"] is defined and dictionary["required"] == "true" %}
		parametar = document.forms['forma'].{{dictionary["name"]}}.value;
		if(parametar==""){
			alert("Niste uneli {{dictionary["name"]}}");
			return false;
		}
		{%- endif %}

		{% if dictionary["min_length"] is defined %}
		parametar = document.forms['forma'].{{dictionary["name"]}}.value.length;
		if(parametar<{{dictionary["min_length"]}}){
			alert("Za polje {{dictionary["name"]}} min_lengthimalna duzina mora biti {{dictionary["min_length"]}} ");
			return false;
		}
		{%- endif %}	
		
		{% if dictionary["type"] is defined and dictionary["type"] == "Integer" %}
		parametar=document.forms['forma'].{{dictionary["name"]}}.value;
		var num = parametar.replace(/\,/g,'');
		if(isNaN(parametar)|| num.indexOf('.') > -1 ) {
				alert("{{dictionary["name"]}} mora biti ceo broj");
				return false;
		}
		{%- endif %}
		{% if dictionary["type"] is defined and dictionary["type"] == "Date" %}
	    vrednost=document.forms['forma'].{{dictionary["name"]}}.value;
	   var date=vrednost.trim();
	   if(vrednost.length!=0){ 
		var niz=new Array();
		niz=date.split('-');
		if(niz.length!=3){
		 alert("Format {{dictionary["name"]}} mora biti dd-MM-yyyy");
		  return false; 
		}else{
		 if(isNaN(niz[0]) || isNaN(niz[1]) || isNaN(niz[2]) || niz[0].length!=2|| niz[1].length!=2|| niz[2].length!=4){
		  alert("Format {{dictionary["name"]}} mora biti dd-MM-yyyy");
		  return false; 
		 }
		}
	   }
		{%- endif %}
		{%- endif %}
		{% endfor %}
		
		{% for dictionary in attributes_parent %}
		{% if dictionary["one_to_many"] is not defined %}
		{% if dictionary["required"] is defined and dictionary["required"] == "true" %}
		parametar = document.forms['forma'].{{dictionary["name"]}}.value;
		if(parametar==""){
			alert("Niste uneli {{dictionary["name"]}}");
			return false;
		}
		{%- endif %}

		{% if dictionary["min_length"] is defined %}
		parametar = document.forms['forma'].{{dictionary["name"]}}.value.length;
		if(parametar<{{dictionary["min_length"]}}){
			alert("Za polje {{dictionary["name"]}} min_lengthimalna duzina mora biti {{dictionary["min_length"]}} ");
			return false;
		}
		{%- endif %}	
		
		{% if dictionary["type"] is defined and dictionary["type"] == "Integer" %}
		parametar=document.forms['forma'].{{dictionary["name"]}}.value;
		var num = parametar.replace(/\,/g,'');
		if(isNaN(parametar)|| num.indexOf('.') > -1 ) {
				alert("{{dictionary["name"]}} mora biti ceo broj");
				return false;
		}
		{%- endif %}
		{% if dictionary["type"] is defined and dictionary["type"] == "Date" %}
	    vrednost=document.forms['forma'].{{dictionary["name"]}}.value;
	   var date=vrednost.trim();
	   if(vrednost.length!=0){ 
		var niz=new Array();
		niz=date.split('-');
		if(niz.length!=3){
		 alert("Format {{dictionary["name"]}} mora biti dd-MM-yyyy");
		  return false; 
		}else{
		 if(isNaN(niz[0]) || isNaN(niz[1]) || isNaN(niz[2]) || niz[0].length!=2|| niz[1].length!=2|| niz[2].length!=4){
		  alert("Format {{dictionary["name"]}} mora biti dd-MM-yyyy");
		  return false; 
		 }
		}
	   }
		{%- endif %}
		{%- endif %}
		{% endfor %}
		
	}	
	</script>
	
	
	
		</head>
		<body>
			<c:if test="${not empty error}">
			    ${error}
			</c:if>
			<form action="./{{name}}UpdateController" method="post" name="forma" onsubmit="return provera()">
				<table >
				
			{% for dictionary in attributes %}
			{% if dictionary["many_to_one"] is defined and dictionary["many_to_one"] == "true" %}
			<tr>
				 <td>{{dictionary["name"]}} {% if dictionary["required"] is defined and dictionary["required"] == "true" %}*{%- endif %}</td>
			 	
					<td><select name="{{dictionary["name"]}}">
							<c:forEach var="temp{{dictionary["type"]}}" items="${list{{dictionary["type"]}}}">
								<option value="${temp{{dictionary["type"]}}.id}">${temp{{dictionary["type"]}}.toString()}</option>
							</c:forEach>
						</select>
					</td>
				</tr>
			{% elif dictionary["enum"] is defined and dictionary["enum"] == "true" %}
			<tr>
				 <td>{{dictionary["name"]}} {% if dictionary["required"] is defined and dictionary["required"] == "true" %}*{%- endif %}</td>
					<td><select name="{{dictionary["name"]}}">
							<c:forEach var="temp{{dictionary["type"]}}" items="<%= model.{{dictionary["type"]}}.values() %>">
								<option value="${temp{{dictionary["type"]}}}">${temp{{dictionary["type"]}}}</option>
							</c:forEach>
						</select>
					</td>
				</tr>
			{% elif dictionary["one_to_many"] is not defined %}
			<tr>
					<td>{{dictionary["name"]}} {% if dictionary["required"] is defined and dictionary["required"] == "true" %}*{%- endif %}</td>
					{% if dictionary["type"] is defined and dictionary["type"] == "Date" %}
					<td>
					<fmt:formatDate value="{% raw %}${{% endraw %}{{name.lower()}}.{{dictionary["name"].lower()}}{% raw %}}{% endraw %}"  type="date" pattern="dd-MM-yyyy" var="theFormattedDate" />
					<input type="text" name="{{dictionary["name"]}}" value="${theFormattedDate}" {% if dictionary["max_length"] is defined  %}max_lengthlength="{{dictionary["max_length"]}}" size="{{dictionary["max_length"]}}"{%- endif %} /> </td>				
					{% else%}
					<td><input type="text" name="{{dictionary["name"]}}" value="{% raw %}${{% endraw %}{{name.lower()}}.{{dictionary["name"].lower()}}{% raw %}}{% endraw %}" {% if dictionary["max_length"] is defined  %}max_lengthlength="{{dictionary["max_length"]}}" size="{{dictionary["max_length"]}}"{%- endif %} /> </td>				
					{% endif %}
			</tr>
			{%- endif %}			
			{% endfor %}
			
			{% for dictionary in attributes_parent %}
			{% if dictionary["many_to_one"] is defined and dictionary["many_to_one"] == "true" %}
			<tr>
				 <td>{{dictionary["name"]}} {% if dictionary["required"] is defined and dictionary["required"] == "true" %}*{%- endif %}</td>
			 	
					<td><select name="{{dictionary["name"]}}">
							<c:forEach var="temp{{dictionary["type"]}}" items="${list{{dictionary["type"]}}}">
								<option value="${temp{{dictionary["type"]}}.id}">${temp{{dictionary["type"]}}.toString()}</option>
							</c:forEach>
						</select>
					</td>
				</tr>
			{% elif dictionary["enum"] is defined and dictionary["enum"] == "true" %}
			<tr>
				 <td>{{dictionary["name"]}} {% if dictionary["required"] is defined and dictionary["required"] == "true" %}*{%- endif %}</td>
					<td><select name="{{dictionary["name"]}}">
							<c:forEach var="temp{{dictionary["type"]}}" items="<%= model.{{dictionary["type"]}}.values() %>">
								<option value="${temp{{dictionary["type"]}}}">${temp{{dictionary["type"]}}}</option>
							</c:forEach>
						</select>
					</td>
				</tr>
			{% elif dictionary["one_to_many"] is not defined %}
			<tr>
					<td>{{dictionary["name"]}} {% if dictionary["required"] is defined and dictionary["required"] == "true" %}*{%- endif %}</td>
					{% if dictionary["type"] is defined and dictionary["type"] == "Date" %}
					<td>
					<fmt:formatDate value="{% raw %}${{% endraw %}{{name.lower()}}.{{dictionary["name"].lower()}}{% raw %}}{% endraw %}"  type="date" pattern="dd-MM-yyyy" var="theFormattedDate" />
					<input type="text" name="{{dictionary["name"]}}" value="${theFormattedDate}" {% if dictionary["max_length"] is defined  %}max_lengthlength="{{dictionary["max_length"]}}" size="{{dictionary["max_length"]}}"{%- endif %} /> </td>				
					{% else%}
					<td><input type="text" name="{{dictionary["name"]}}" value="{% raw %}${{% endraw %}{{name.lower()}}.{{dictionary["name"].lower()}}{% raw %}}{% endraw %}" {% if dictionary["max_length"] is defined  %}max_lengthlength="{{dictionary["max_length"]}}" size="{{dictionary["max_length"]}}"{%- endif %} /> </td>				
					{% endif %}
			</tr>
			{%- endif %}			
			{% endfor %}
	
					<tr>
						<td>&nbsp;</td>
						<td><input type="hidden" name="id" value="{% raw %}${{% endraw %}{{name.lower()}}.id{% raw %}}{% endraw %}"></td>
						<td><input type="submit" name="submit" value="Izmeni {{name}}"></td>
					</tr>
				</table>
			</form>
			<p> <a href="./home.jsp">Pocetna</a>  </p>
		</body>
	</html>